(this.webpackJsonpmtg_stats=this.webpackJsonpmtg_stats||[]).push([[0],{11:function(e,a,t){e.exports=t(21)},19:function(e,a,t){},20:function(e,a,t){},21:function(e,a,t){"use strict";t.r(a);var l=t(1),r=t.n(l),n=t(9),c=t.n(n),o=(t(19),t(2)),s=t(10);const m=Object(s.a)({apiKey:"AIzaSyBTzfDF8Hqxob52odaaoyUmTOhbu54jbIY",authDomain:"mtgstats-864da.firebaseapp.com",databaseURL:"https://mtgstats-864da-default-rtdb.firebaseio.com",projectId:"mtgstats-864da",storageBucket:"mtgstats-864da.appspot.com",messagingSenderId:"68211953531",appId:"1:68211953531:web:3619c6cc482a2bfeeb77de",measurementId:"G-78HCZP9LD6"}),i=Object(o.c)(m);var g=function(e){let{onGameSelect:a}=e;const[t,n]=Object(l.useState)(""),[c,s]=Object(l.useState)(""),[m,g]=Object(l.useState)([]),u=Object(l.useRef)([]);Object(l.useEffect)(()=>{const e=Object(o.f)(i,"games");Object(o.d)(e,e=>{const a=e.val();if(a){const e=Object.keys(a).map(e=>({id:e,gameName:a[e].gameName}));u.current=e,g(e)}});const a=localStorage.getItem("playerName");a&&s(a)},[]);const b=()=>{const e=localStorage.getItem("gameID"),a=localStorage.getItem("playerID");if(e&&a){const t=Object(o.f)(i,`games/${e}/players/${a}`);Object(o.g)(t).then(()=>{console.log("Jugador eliminado de la partida anterior");const a=Object(o.f)(i,`games/${e}/players`);Object(o.d)(a,a=>{const t=a.val();t&&0!==Object.keys(t).length||Object(o.g)(Object(o.f)(i,"games/"+e)).then(()=>console.log("Partida eliminada")).catch(e=>console.error("Error al eliminar partida:",e))})}).catch(e=>console.error("Error al eliminar jugador:",e))}};return r.a.createElement("div",{className:"landingPage"},r.a.createElement("p",null,"\xdanete a una partida o crea una nueva"),r.a.createElement("input",{className:"input",type:"text",placeholder:"Nombre de jugador",value:c,onChange:e=>s(e.target.value)}),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"gameSelect"},"Elige un juego ya creado: "),r.a.createElement("select",{className:"select",id:"gameSelect",onChange:e=>(e=>{if(!c)return alert("Error: Por favor ingresa un nombre de jugador.");e!==localStorage.getItem("gameID")&&b();const t=localStorage.getItem("playerID")||Object(o.e)(Object(o.f)(i,"games")).key;localStorage.setItem("playerID",t),localStorage.setItem("playerName",c),localStorage.setItem("gameID",e);const l=Object(o.f)(i,`games/${e}/players/${t}`);Object(o.h)(l,{playerName:c,life:40,mana:{red:0,blue:0,green:0,black:0,white:0,colorless:0}}).then(()=>{alert("Jugador a\xf1adido a la partida existente"),a(e)}).catch(e=>{console.error("Error al a\xf1adir jugador:",e)})})(e.target.value)},m.map(e=>r.a.createElement("option",{key:e.id,value:e.id},e.gameName)))),r.a.createElement("input",{className:"input",type:"text",placeholder:"Crear partida",value:t,onChange:e=>n(e.target.value)}),r.a.createElement("button",{onClick:()=>{if(!c)return alert("Error: Por favor ingresa un nombre de jugador.");const e=u.current.map(e=>e.gameName);if(!t)return alert("Error: Por favor ingresa un nombre de partida.");if(e.includes(t))return alert("Error: partida ya existente");{b();const e=localStorage.getItem("playerID")||Object(o.e)(Object(o.f)(i,"games")).key;localStorage.setItem("playerID",e),localStorage.setItem("playerName",c);const l=Object(o.e)(Object(o.f)(i,"games")),r=l.key;localStorage.setItem("gameID",r),Object(o.h)(l,{gameName:t,players:{[e]:{playerName:c,life:40,mana:{red:0,blue:0,green:0,black:0,white:0,colorless:0}}}}).then(()=>{alert("Partida creada"),a(r)}).catch(e=>{alert("Error: "+e.message)})}}},"Crear partida"))};var u=e=>{let{gameID:a}=e;const t=localStorage.getItem("playerID"),n=Object(o.f)(i,`games/${a}/players/${t}`),[c,s]=Object(l.useState)(""),[m,g]=Object(l.useState)(40),[u,b]=Object(l.useState)({red:0,blue:0,green:0,black:0,white:0,colorless:0}),d=e=>{g(e),Object(o.i)(n,{life:e})},p=(e,a)=>{const t={...u,[e]:u[e]+a};b(t),Object(o.i)(n,{mana:t})};return Object(l.useEffect)(()=>{const e=Object(o.d)(n,e=>{const a=e.val();a&&(s(a.playerName||""),g(void 0!==a.life?a.life:40),JSON.stringify(a.mana)!==JSON.stringify(u)&&b(a.mana||{red:0,blue:0,green:0,black:0,white:0,colorless:0}))});return()=>e()},[n,u]),r.a.createElement("div",{className:"principalPlayer"},r.a.createElement("div",{className:"infoPP"},r.a.createElement("h2",null,c),r.a.createElement("p",null,"Vida: ",m)),r.a.createElement("ul",{className:"lifeButtons"},r.a.createElement("li",null,r.a.createElement("button",{onClick:()=>d(m-1)},"-1")),r.a.createElement("li",null,r.a.createElement("button",{onClick:()=>d(m+1)},"+1")),r.a.createElement("li",null,r.a.createElement("button",{onClick:()=>d(m-5)},"-5")),r.a.createElement("li",null,r.a.createElement("button",{onClick:()=>d(m+5)},"+5"))),r.a.createElement("div",{className:"manaButtons"},Object.keys(u).map(e=>r.a.createElement("div",{key:e},r.a.createElement("p",null,e.charAt(0).toUpperCase()+e.slice(1),": ",u[e]),r.a.createElement("button",{onClick:()=>p(e,-1)},"-1"),r.a.createElement("button",{onClick:()=>p(e,1)},"+1")))))};var b=e=>{let{opponentID:a,gameID:t}=e;const[n,c]=Object(l.useState)(40),[s,m]=Object(l.useState)(""),[g,u]=Object(l.useState)({red:0,blue:0,green:0,black:0,white:0,colorless:0});return Object(l.useEffect)(()=>{if(!a||!t)return void console.warn("Missing opponentID or gameID:",{opponentID:a,gameID:t});const e=Object(o.f)(i,`games/${t}/players/${a}`);Object(o.d)(e,e=>{const a=e.val();a?(m(a.playerName||"Jugador sin nombre"),c(void 0!==a.life?a.life:40),u({red:a.manaRed||0,blue:a.manaBlue||0,green:a.manaGreen||0,black:a.manaBlack||0,white:a.manaWhite||0,colorless:a.manaColorless||0})):console.log("Datos del oponente no encontrados.")})},[a,t]),r.a.createElement("div",{className:"oponente"},r.a.createElement("p",null,s),r.a.createElement("h2",null,n),r.a.createElement("ul",null,r.a.createElement("p",null,"Man\xe1:"),Object.entries(g).filter(e=>{let[a,t]=e;return 0!==t}).map(e=>{let[a,t]=e;return r.a.createElement("li",{key:a},a.charAt(0).toUpperCase()+a.slice(1),": ",t)})))};var d=function(e){let{gameID:a}=e;const[t,n]=Object(l.useState)(""),[c,s]=Object(l.useState)([]),m=localStorage.getItem("playerID");return!a&&localStorage.getItem("gameID")&&(a=localStorage.getItem("gameID")),Object(l.useEffect)(()=>{if(a){const e=Object(o.f)(Object(o.c)());Object(o.b)(Object(o.a)(e,"games/"+a)).then(e=>{if(e.exists()){const a=e.val();n(a.gameName),a.players?s(Object.keys(a.players)):s([])}else console.log("No data available")}).catch(e=>{console.error(e)})}},[a]),a&&m?r.a.createElement("div",{className:"game"},r.a.createElement("h2",{className:"gameName"}," Partida: ",t),r.a.createElement(u,{gameID:a}),r.a.createElement("ul",{className:"listaDeOponentes"},c.filter(e=>e!==m).map(e=>r.a.createElement("li",{key:e},r.a.createElement(b,{opponentID:e,gameID:a}))))):r.a.createElement("div",{className:"game"},r.a.createElement("h2",{className:"gameName"},"Por favor, selecciona o crea una partida."))};t(20);var p=function(){const[e,a]=Object(l.useState)("");return r.a.createElement("div",null,r.a.createElement(g,{onGameSelect:e=>{a(e)}}),r.a.createElement(d,{gameID:e}))};var E=e=>{e&&e instanceof Function&&t.e(3).then(t.bind(null,22)).then(a=>{let{getCLS:t,getFID:l,getFCP:r,getLCP:n,getTTFB:c}=a;t(e),l(e),r(e),n(e),c(e)})};c.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(p,null))),E()}},[[11,1,2]]]);
//# sourceMappingURL=main.b1e1b114.chunk.js.map